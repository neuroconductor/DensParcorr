<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conduct the Dens-Based approach for partial correlation estimation — DensParcorr • DensParcorr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Conduct the Dens-Based approach for partial correlation estimation — DensParcorr" />
<meta property="og:description" content="This function is to conduct the Dens-based approach for partial correlation estimation in large scale brain network study.
DensParcorr is the main function in this package. prec2dens and prec2part are sub-functions called by DensParcorr." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DensParcorr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conduct the Dens-Based approach for partial correlation estimation</h1>
    
    <div class="hidden name"><code>DensParcorr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is to conduct the <em>Dens</em>-based approach for partial correlation estimation in large scale brain network study.<br />
DensParcorr is the main function in this package. prec2dens and prec2part are sub-functions called by DensParcorr.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>DensParcorr</span><span class='op'>(</span><span class='va'>data</span>,select<span class='op'>=</span><span class='cn'>FALSE</span>,dens.level<span class='op'>=</span><span class='st'>"plateau"</span>,plateau.thresh<span class='op'>=</span><span class='fl'>0.01</span>,
            Parcorr.est<span class='op'>=</span><span class='cn'>NULL</span>,directory<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Input data matrix with dimension of TxM where T is the number of observations and M is the number of nodes. For example, in fMRI data the T is the number of scans.</p></td>
    </tr>
    <tr>
      <th>select</th>
      <td><p>Whether to conduct the <em>Dens</em>-based selection. If FALSE, output will only contain the estimated partial correlation list and precision matrix list corresponding to the default tuning parameter series ranging from 1e-8 to 0.6. If TRUE, the ouput will include the previous results and the selected partial correlation matrix and percision matrix corresponding to the specified density level. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>dens.level</th>
      <td><p>Specify the density level in <em>Dens</em>-based tuning parameter selection method, including the plateau based density selection (<code>dens.level</code> = "plateau") and p percentage density selection (<code>dens.level</code> = p, 0&lt;p&lt;1). This option is valid only when <code>select</code>=TRUE. See Details. Default is "plateau".</p></td>
    </tr>
    <tr>
      <th>plateau.thresh</th>
      <td><p>The criterion to select the plateau. This option is valid only when <code>select</code>=TRUE. See Details. Default value is 0.01.</p></td>
    </tr>
    <tr>
      <th>Parcorr.est</th>
      <td><p>Previous output from DensParcorr function.</p></td>
    </tr>
    <tr>
      <th>directory</th>
      <td><p>The directory to output the figures and precision matrices and the partial correlation matrices. The default (<code>directory</code>=<code>NULL</code>) is to output in the current working directory.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function implements the statistical method proposed in Wang et al. (2016) to estimate partial correlation matrix for studying direct connectivity in large-scale brain network. The method derives partial correlation based on the precision matrix estimated via Constrained L1-minimization Approach (CLIME) (Cai et al., 2011). This function applies the <em>Dens</em>-based tuning parameter selection method in Wang et al. (2016) to help select an appropriate tuning parameter for sparsity control in the network estimation. Below is the breif step of <em>Dens</em>-based approach.<br /></p>  
<p>First, we specify a series of tuning parameters {\(\lambda_n\)}. Then, based on {\(\lambda_n\)} we esimate a list of precision matices \(\Omega(\lambda_n)\) and and evaluate the density level of each precision matrix based on the <em>Dens</em> criterion function in equation (5) of Wang et al. (2016). This will provide the users the profile of the density level corresponding to the series of tuning parameters in {\(\lambda_n\)}. Users can use the <code>dens.level</code> option to specify the desired density level in the precision matrix estimation. If <code>dens.level</code>="plateau", the function will select the plateau point \(\lambda_{platu}\) in the density profile based on the <code>plateau.thresh</code> and output the precision matrix \(\Omega(\lambda_{platu})\). If <code>dens.level</code>=p and 0&lt;p&lt;1, the function will select the tuning parameter \(\lambda_p\) to achieve p percentage density and output the precision matrix \(\Omega(\lambda_p)\). Then, the partial correlation matrix will be derived from the precision matrix. Further details can be found in the Reference. <br /></p>  
<p>The density profile and the heatmaps of precision matrices and partial correlation matrices will be saved in <code>directory</code>, and the esimated list of precision matrices and partial correlation matrices will also be saved in <code>directory</code>. <br /></p>  
<p>When users would like to run the function multiple times on the same input data for different <code>dens.level</code>, it is computationally more efficient to read in the previous output from DensParcorr to <code>Parcorr.est</code> so that the function won't need to re-estimate the partial correlations based on the previous tuning parameters.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An R list from DensParcorr containing the following terms:</p>
<dt>selected.partial.corr</dt><dd><p>Selected Partial Correlation matrix corresponding to <code>dens.level</code>. Only when <code>select</code>=TRUE.</p></dd>
   <dt>selected.precision</dt><dd><p>Selected Precision matrix corresponding to <code>dens.level</code>. Only when <code>select</code>=TRUE.</p></dd>
   <dt>selected.lambda</dt><dd><p>Selected tuning parameter corresponding to <code>dens.level</code>. Only when <code>select</code>=TRUE.</p></dd>
   <dt>lambda.list</dt><dd><p>The series of tuning parameters used for esimation and density profile.</p></dd>
   <dt>partial.corr.list</dt><dd><p>Estimated Partial Correlation matrix list corresponding to <code>lambda.list</code>.</p></dd>
   <dt>precision.list</dt><dd><p>Estimated Precision matrix list corresponding to <code>lambda.list</code>.</p></dd>
   <dt>Dens</dt><dd><p>Actual density levels for estimated precision matrix list.</p></dd>
   <dt>Dens.Percentage</dt><dd><p>Actual percentage density levels for estimated precision matrix list.</p></dd>   
   <dt>selection.method</dt><dd><p>The method used for tuning parameter selection. For percentage <em>Dens</em> selection, this value will include the actual <em>Dens</em> precentage and the nominal <em>Dens</em> percentage. Only when <code>select</code>=TRUE.</p></dd>

  
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Wang, Y., Kang, J., Kemmer P. and Guo, Y. (2016).   <em>
     An efficient and reliable statistical method for estimating functional connectivity in large scale brain networks using partial correlation.
  </em> Front. Neurosci. 10:123. doi: 10.3389/fnins.2016.00123</p>  
<p>Cai, T.T., Liu, W., and Luo, X. (2011).   <em>
     A constrained \(\ell_1\)
  minimization approach for sparse precision matrix estimation.
  </em> Journal of the American Statistical Association 106(494): 594-607.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Yikai Wang, Jian Kang, Phebe Brenne Kemmer and Ying Guo<br />
  Maintainer: Yikai Wang <a href='mailto:yikai.wang@emory.edu'>yikai.wang@emory.edu</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'># require(gplots)</span></span>
<span class='r-in'><span class='co'># require(clime)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Simulated the data to use. </span></span>
<span class='r-in'><span class='co'># data = matrix(rnorm(200),ncol=20)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##### Example 1: Estimate the partial correlation matrices for the </span></span>
<span class='r-in'><span class='co'>##### default series of tuning parameters. </span></span>
<span class='r-in'><span class='co'># t0 = proc.time()[3]</span></span>
<span class='r-in'><span class='co'># dens.est = DensParcorr(data,select=FALSE)</span></span>
<span class='r-in'><span class='co'># proc.time()[3]-t0</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##### Example 2: Estimate the network that reaches 40% density level. </span></span>
<span class='r-in'><span class='co'># partial.dens.est = DensParcorr(data,dens.level  =.4,select=TRUE)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>###### Example 3: Now, estimate the 60% density level network based </span></span>
<span class='r-in'><span class='co'>###### on the same data. To speed up computation, we read in the </span></span>
<span class='r-in'><span class='co'>###### previous output from Example 2 into Parcorr.est</span></span>
<span class='r-in'><span class='co'># t0 = proc.time()[3]</span></span>
<span class='r-in'><span class='co'># partial.dens.est2 = DensParcorr(data, Parcorr.est = partial.dens.est,</span></span>
<span class='r-in'><span class='co'>#                                 dens.level=.6,select=TRUE)</span></span>
<span class='r-in'><span class='co'># proc.time()[3]-t0</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Yikai Wang.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


